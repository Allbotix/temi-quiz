<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Temi Quiz</title>

<style>
/* GENERAL PAGE STYLES */
html,body{
  margin:0;padding:0;
  width:100%;height:100%;
  font-family:Arial, sans-serif;
  background:#0a1f44; /* deep blue theme */
  overflow:hidden;
}

/* SPLASH SCREEN */
#splash {
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  background:url("background.png") no-repeat center center/cover;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  color:white;
  z-index:9999;
}

#splashText{
  font-size:4rem;
  font-weight:bold;
  letter-spacing:4px;
  animation:fade 3s infinite;
}

@keyframes fade{
  0%{opacity:0;}
  50%{opacity:1;}
  100%{opacity:0;}
}

/* QUIZ SCREEN */
#quizContainer{
  display:none;
  width:100%;height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  padding:20px;
}

#question{
  font-size:2.8rem;
  font-weight:bold;
  margin-bottom:40px;
  padding:0 25px;
  color:white;
}

/* GLASS EFFECT ANSWER BUTTONS */
.answer, #rating button{
  width:85%;
  padding:30px;
  margin:12px 0;
  font-size:2rem;
  border:none;
  border-radius:25px;
  color:white;
  backdrop-filter:blur(10px);
  background:rgba(255,255,255,0.15);
  border:1px solid rgba(255,255,255,0.25);
  box-shadow:0 8px 25px rgba(0,0,0,0.2);
  position:relative;
  overflow:hidden;
  transition:all 0.25s ease-in-out;
}

/* Hover effect */
.answer:hover,
#rating button:hover {
  transform:scale(1.06);
  box-shadow:0 0 25px rgba(0,150,255,0.8);
  cursor:pointer;
}

/* Ripple Effect */
.answer:active::after,
#rating button:active::after{
  content:"";
  position:absolute;
  width:250px;height:250px;
  background:rgba(255,255,255,0.3);
  border-radius:50%;
  transform:scale(0);
  animation:ripple 0.6s linear;
  left:50%;top:50%;
  transform:translate(-50%,-50%) scale(0);
}
@keyframes ripple{
  to{transform:translate(-50%,-50%) scale(3);opacity:0;}
}

/* SPEAK BUTTON */
#speak{
  font-size:3.5rem;
  background:none;
  border:none;
  margin-bottom:20px;
  color:white;
}

/* NAV BUTTONS */
.navbtn{
  position:fixed;
  bottom:25px;
  padding:22px 35px;
  font-size:2rem;
  border:none;
  border-radius:20px;
  background:rgba(0,0,0,0.5);
  color:white;
  backdrop-filter:blur(6px);
  box-shadow:0 4px 15px rgba(0,0,0,0.4);
}
#prev{ left:25px; }
#next{ right:25px; }
</style>
</head>

<body>

<!-- SPLASH SCREEN -->
<div id="splash" onclick="startQuiz()">
  <div id="splashText">Allbotix</div>
</div>

<!-- QUIZ SCREEN -->
<div id="quizContainer">

  <button id="speak">ðŸ”Š</button>

  <div id="question">Loading...</div>

  <div id="options"></div>
  <div id="rating" style="display:none;"></div>

  <button id="prev" class="navbtn">â¬… Prev</button>
  <button id="next" class="navbtn">Next âž¡</button>

</div>

<script>
/************************
  CONFIG
*************************/
const API_URL = "https://script.google.com/macros/s/AKfycbzVgZWYScmH7II7TK4rg3-tbZFW-sEdhFMqDUXCQZiUhc8KkW_5xzzVs6QlqprPoIlC/exec";

let questions=[];
let index=0;

/************************
  START QUIZ
*************************/
function startQuiz(){
  document.getElementById("splash").style.display="none";
  document.getElementById("quizContainer").style.display="flex";
  loadQuestions();
}

/************************
  LOAD QUESTIONS
*************************/
function loadQuestions(){
  fetch(API_URL)
    .then(r=>r.json())
    .then(data=>{
      questions = data.filter(q => String(q.enabled).toLowerCase()==="true");
      showQ();
    });
}

/************************
  SHOW QUESTION
*************************/
function showQ(){
  if(!questions.length) return;

  const q = questions[index];
  document.getElementById("question").innerText = q.question;

  const opts=document.getElementById("options");
  const rating=document.getElementById("rating");

  opts.innerHTML="";
  rating.innerHTML="";
  rating.style.display="none";

  if(q.type==="mcq"){
    [q.option1,q.option2,q.option3,q.option4].forEach(opt=>{
      let b=document.createElement("button");
      b.className="answer";
      b.innerText=opt;

      /* Speak on hover */
      b.onmouseenter=()=>speak(opt);

      b.onclick=()=>saveAnswer(opt);
      opts.appendChild(b);
    });
  } else {
    rating.style.display="block";
    for(let i=1;i<=10;i++){
      let b=document.createElement("button");
      b.className="answer";
      b.innerText=i;

      b.onmouseenter=()=>speak("Rating " + i);

      b.onclick=()=>saveAnswer(i);
      rating.appendChild(b);
    }
  }

  speak(q.question);
}

/************************
  TEXT TO SPEECH
*************************/
function speak(text){
  speechSynthesis.cancel();
  speechSynthesis.speak(new SpeechSynthesisUtterance(text));
}

document.getElementById("speak").onclick=function(){
  const q = questions[index];
  if(q.type==="mcq"){
    speak(q.question + ". Options are " + q.option1 + ", " + q.option2 + ", " + q.option3 + ", " + q.option4);
  } else {
    speak(q.question + ". Please rate from 1 to 10.");
  }
};

/************************
  SAVE ANSWER
*************************/
function saveAnswer(ans){
  const params = new URLSearchParams();
  params.append("action","saveResponse");
  params.append("questionId", questions[index].id);
  params.append("answer", ans);
  params.append("timestamp", Date.now());

  fetch(API_URL,{
    method:"POST",
    mode:"no-cors",
    body:params
  })
  .finally(()=>{
    if(index < questions.length-1){
      index++;
      showQ();
    } else showComplete();
  });
}

/************************
  NEXT / PREV
*************************/
document.getElementById("next").onclick=function(){
  if(index<questions.length-1){
    index++; showQ();
  }
};
document.getElementById("prev").onclick=function(){
  if(index>0){
    index--; showQ();
  }
};

/************************
  THANK YOU SCREEN
*************************/
function showComplete(){
  document.body.innerHTML=`
    <div style="
      width:100%;height:100%;
      background:url('background.png') no-repeat center center/cover;
      display:flex;
      justify-content:center;
      align-items:center;
      color:white;
      font-size:3rem;
      text-align:center;">
      Thank You ðŸŽ‰
    </div>
  `;
  setTimeout(()=>location.href="user.html",10000);
}

</script>
</body>
</html>
