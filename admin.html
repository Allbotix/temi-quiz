<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body{
  background:#eef3ff;padding:20px;
  font-family:Arial, sans-serif;
}
.card{
  padding:20px;border-radius:15px;
  box-shadow:0 6px 20px rgba(0,0,0,0.1);
}
.btn-primary{
  background:linear-gradient(135deg,#5a8dee,#8868ff);border:none;
}
</style>
</head>

<body>
<div class="container">

<h1 class="mb-4">Temi Quiz Admin</h1>

<div class="card mb-4">
  <h3>Add Question</h3>

  <label>Question</label>
  <input id="qText" class="form-control mb-2">

  <label>Type</label>
  <select id="qType" class="form-control mb-2">
    <option value="mcq">Multiple Choice</option>
    <option value="rating">Rating 1-10</option>
  </select>

  <div id="mcqBox">
    <input id="o1" class="form-control mb-1" placeholder="Option 1">
    <input id="o2" class="form-control mb-1" placeholder="Option 2">
    <input id="o3" class="form-control mb-1" placeholder="Option 3">
    <input id="o4" class="form-control mb-2" placeholder="Option 4">
  </div>

  <div>
    <label>Enabled</label>
    <input type="checkbox" id="enabled" checked>
  </div>

  <button class="btn btn-primary mt-3" onclick="addQ()">Add Question</button>
</div>

<div class="card">
  <h3>All Questions</h3>
  <table class="table table-bordered" id="qTable">
    <thead>
      <tr>
        <th>ID</th><th>Question</th><th>Type</th><th>Enabled</th><th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbzVgZWYScmH7II7TK4rg3-tbZFW-sEdhFMqDUXCQZiUhc8KkW_5xzzVs6QlqprPoIlC/exec";

document.getElementById("qType").onchange=function(){
  document.getElementById("mcqBox").style.display =
    this.value==="mcq" ? "block" : "none";
};

function loadQ(){
  fetch(API_URL)
    .then(r=>r.json())
    .then(showTable);
}
loadQ();

function showTable(list){
  const body=document.querySelector("#qTable tbody");
  body.innerHTML="";
  list.forEach(q=>{
    let row=document.createElement("tr");
    row.innerHTML=`
      <td>${q.id}</td>
      <td>${q.question}</td>
      <td>${q.type}</td>
      <td>${q.enabled}</td>
      <td>
        <button class='btn btn-sm btn-warning' onclick='edit(${q.id})'>Edit</button>
        <button class='btn btn-sm btn-danger' onclick='del(${q.id})'>Delete</button>
      </td>`;
    body.appendChild(row);
  });
}

function addQ(){
  fetch(API_URL,{
    method:"POST",
    body:new URLSearchParams({
      action:"addQuestion",
      question:document.getElementById("qText").value,
      type:document.getElementById("qType").value,
      option1:o1.value,option2:o2.value,option3:o3.value,option4:o4.value,
      enabled:document.getElementById("enabled").checked
    })
  }).then(loadQ);
}

function del(id){
  fetch(API_URL,{
    method:"POST",
    body:new URLSearchParams({action:"deleteQuestion",id})
  }).then(loadQ);
}

function edit(id){
  let newQ=prompt("Update Question:");
  if(!newQ) return;
  fetch(API_URL,{
    method:"POST",
    body:new URLSearchParams({
      action:"editQuestion",id,
      question:newQ,
      type:"mcq",
      option1:"",option2:"",option3:"",option4:"",
      enabled:true
    })
  }).then(loadQ);
}
</script>

</body>
</html>
